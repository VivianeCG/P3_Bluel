function createButton() {
  const urlCategories = "http://localhost:5678/api/categories";
  fetch(urlCategories)
    .then(function (response) {
      return response.json();
    })
    .then(function (data) {
      let numeroId = 1;
      data.forEach((element) => {
        //pour créer les boutons des filtres avec leurs noms et id(sauf "Tous")
        let divConteneurCategories = document.getElementById("filtres");
        let button = document.createElement("button");
        button.setAttribute("class", "categorie");
        button.setAttribute("id", "categorie" + numeroId);
        numeroId++;
        button.setAttribute("value", numeroId);
        divConteneurCategories.appendChild(button);
        button.innerHTML = element.name;
        console.log(button);
      });
    });
}
createButton();

function filtrageCategories() {
  console.log("coucou");
  const url = "http://localhost:5678/api/works";
  let button = document.querySelectorAll(".categorie");
  for (const filtrage of button) {
    filtrage.addEventListener("click", () => {
      let conteneurParent = document.getElementById("gallery");
      conteneurParent = "";
      fetch(url)
        .then((response) => response.json())
        .then((data) => {
          if (filtrage.value == 1) {
            creationFigure();
            console.log(filtrage.value);
          } else {
            console.log(filtrage.value);
            for (let element of data) {
              if (element.categoryId == filtrage.value) {
                let conteneurParent = document.getElementById("gallery");
                let conteneurPhoto = "";
                conteneurPhoto.innerHTML += `
                                                        <figure>
                                                        <img src=${data[element].imageUrl} alt=${data[element].title}>
                                                        <figcaption>${data[element].title}</figcaption>
                                                        </figure>
                                                        `;
                conteneurParent.appendChild(conteneurPhoto);
              }
            }
          }
        });
    });
  }
}
filtrageCategories();

fetch(url)
.then(function (response) {
  return response.json();
})
.then(function(data){
})

//récupérer les boutons par id ou class ("categorie" + numberId) class="categorie"
//mettre un eventlistener pour le clic sur le bouton
//l'appel à l'API retourne un tableau, mettre le tableau dans un set?
//boucler sur le set pour récupérer selon les categoryID  ou l'element.id:  pour les objets 1
// 2 pour apparts et 3 pour hotels restos?
// categorie0 attribuée à "tous"
//condition si id categorie et id bouton match alors on affiche les travaux
//par défaut ("tous") affiche tous les travaux
//appeler la fonction createFigure si ça matche? 
// attention faire appel à la fonction createButton dans cette fonction double les boutons
function filterWorks(){
  createButton();
  let filterButtons = document.querySelectorAll(".categorie");
  const url = "http://localhost:5678/api/works";
  for (const button of filterButtons) {
    button.addEventListener("click", () => {
      fetch(url)
      .then(function (response) {
        return response.json();
      })
      .then(function(data){
        console.log("clicked button value", button);
        if (button.value==0) {
          createFigure();
          console.log("testTous");
        } else {

          console.log("testAutresBoutons");
        }
      })
    })
    
  }
}
filterWorks();

function filterWorks() {
  const url = "http://localhost:5678/api/works";
  let categoryId = button.value;
  document.getElementById("filtres").addEventListener("click", function(event) {
    if (event.target && event.target.matches(".categorie")) {
      fetch(url)
        .then(function(response) {
          return response.json();
        })
        .then(function(data) {
          console.log(event.target);
          if (event.target.value == 0) {
            createFigure();
            console.log("testTous");
          } else {
            console.log("testAutresBoutons");

          }
        });
    }
  });
}
createButton();
filterWorks();


const parentContainer = document.getElementById("gallery");
parentContainer.innerHTML = "";
let photoContainer = document.createElement("figure");
let galleryImage = document.createElement("img");
let photoLegend = document.createElement("figcaption");
photoLegend.innerText = "légende photo";
parentContainer.appendChild(photoContainer);
photoContainer.appendChild(galleryImage);
photoContainer.appendChild(photoLegend);
galleryImage.setAttribute("src", "");
galleryImage.setAttribute("alt", "");
galleryImage.src = element.imageUrl;
galleryImage.alt = element.title;
photoLegend.innerHTML = element.title;

